2025-11-12 11:50:33,345 - INFO - Inizializzazione Order_layer_graph per Scavo archeologico - 1
2025-11-12 11:50:33,587 - INFO - Avvio caricamento dati dal database...
2025-11-12 11:50:33,610 - INFO - Tipo database rilevato: SQLite
2025-11-12 11:50:33,614 - DEBUG - Esecuzione query: 
            SELECT us, rapporti 
            FROM us_table 
            WHERE sito = 'Scavo archeologico' AND area = '1'
            
2025-11-12 11:50:33,634 - DEBUG - Caricate 50 US...
2025-11-12 11:50:33,641 - INFO - Completato: caricate 51 US dal database
2025-11-12 11:50:33,643 - INFO - Costruzione del grafo stratigrafico...
2025-11-12 11:50:33,645 - DEBUG - Aggiunta relazione: 1 -> 2 (Copre)
2025-11-12 11:50:33,646 - DEBUG - Aggiunta relazione: 1 -> 8 (Copre)
2025-11-12 11:50:33,646 - DEBUG - Aggiunta relazione: 2 -> 3 (Copre)
2025-11-12 11:50:33,647 - DEBUG - Aggiunta relazione: 3 -> 10 (Copre)
2025-11-12 11:50:33,647 - DEBUG - Aggiunta relazione: 3 -> 11 (Copre)
2025-11-12 11:50:33,648 - DEBUG - Aggiunta relazione: 3 -> 12 (Copre)
2025-11-12 11:50:33,648 - DEBUG - Aggiunta relazione: 3 -> 14 (Copre)
2025-11-12 11:50:33,649 - DEBUG - Aggiunta relazione: 3 -> 16 (Copre)
2025-11-12 11:50:33,650 - DEBUG - Aggiunta relazione: 3 -> 4 (Copre)
2025-11-12 11:50:33,650 - DEBUG - Aggiunta relazione: 3 -> 5 (Copre)
2025-11-12 11:50:33,651 - DEBUG - Aggiunta relazione: 3 -> 6 (Copre)
2025-11-12 11:50:33,651 - DEBUG - Aggiunta relazione: 3 -> 9 (Copre)
2025-11-12 11:50:33,652 - DEBUG - Aggiunta relazione: 4 -> 17 (Copre)
2025-11-12 11:50:33,652 - DEBUG - Aggiunta relazione: 4 -> 18 (Copre)
2025-11-12 11:50:33,653 - DEBUG - Aggiunta relazione: 4 -> 19 (Copre)
2025-11-12 11:50:33,653 - DEBUG - Aggiunta relazione: 4 -> 20 (Copre)
2025-11-12 11:50:33,654 - DEBUG - Aggiunta relazione: 4 -> 23 (Copre)
2025-11-12 11:50:33,654 - DEBUG - Aggiunta relazione: 4 -> 25 (Copre)
2025-11-12 11:50:33,654 - DEBUG - Aggiunta relazione: 4 -> 27 (Copre)
2025-11-12 11:50:33,658 - DEBUG - Aggiunta relazione: 4 -> 5 (Copre)
2025-11-12 11:50:33,661 - DEBUG - Aggiunta relazione: 4 -> 21 (Riempie)
2025-11-12 11:50:33,663 - DEBUG - Aggiunta relazione: 4 -> 6 (Si appoggia a)
2025-11-12 11:50:33,666 - DEBUG - Aggiunta relazione: 5 -> 29 (Copre)
2025-11-12 11:50:33,668 - DEBUG - Aggiunta relazione: 5 -> 32 (Copre)
2025-11-12 11:50:33,670 - DEBUG - Aggiunta relazione: 5 -> 6 (Si appoggia a)
2025-11-12 11:50:33,672 - DEBUG - Aggiunta relazione: 7 -> 2 (Taglia)
2025-11-12 11:50:33,674 - DEBUG - Aggiunta relazione: 8 -> 7 (Riempie)
2025-11-12 11:50:33,677 - DEBUG - Aggiunta relazione: 9 -> 4 (Copre)
2025-11-12 11:50:33,679 - DEBUG - Aggiunta relazione: 10 -> 11 (Copre)
2025-11-12 11:50:33,681 - DEBUG - Aggiunta relazione: 11 -> 4 (Copre)
2025-11-12 11:50:33,683 - DEBUG - Aggiunta relazione: 12 -> 6 (Si appoggia a)
2025-11-12 11:50:33,685 - DEBUG - Aggiunta relazione: 13 -> 18 (Taglia)
2025-11-12 11:50:33,687 - DEBUG - Aggiunta relazione: 13 -> 4 (Taglia)
2025-11-12 11:50:33,689 - DEBUG - Aggiunta relazione: 14 -> 13 (Riempie)
2025-11-12 11:50:33,691 - DEBUG - Aggiunta relazione: 15 -> 4 (Taglia)
2025-11-12 11:50:33,694 - DEBUG - Aggiunta relazione: 16 -> 15 (Riempie)
2025-11-12 11:50:33,696 - DEBUG - Aggiunta relazione: 17 -> 30 (Copre)
2025-11-12 11:50:33,698 - DEBUG - Aggiunta relazione: 17 -> 5 (Copre)
2025-11-12 11:50:33,700 - DEBUG - Aggiunta relazione: 17 -> 28 (Riempie)
2025-11-12 11:50:33,702 - DEBUG - Aggiunta relazione: 18 -> 29 (Copre)
2025-11-12 11:50:33,705 - DEBUG - Aggiunta relazione: 18 -> 31 (Copre)
2025-11-12 11:50:33,707 - DEBUG - Aggiunta relazione: 18 -> 19 (Si appoggia a)
2025-11-12 11:50:33,709 - DEBUG - Aggiunta relazione: 18 -> 5 (Si appoggia a)
2025-11-12 11:50:33,711 - DEBUG - Aggiunta relazione: 18 -> 6 (Si appoggia a)
2025-11-12 11:50:33,713 - DEBUG - Aggiunta relazione: 20 -> 19 (Si appoggia a)
2025-11-12 11:50:33,716 - DEBUG - Aggiunta relazione: 21 -> 18 (Taglia)
2025-11-12 11:50:33,718 - DEBUG - Aggiunta relazione: 22 -> 18 (Taglia)
2025-11-12 11:50:33,720 - DEBUG - Aggiunta relazione: 23 -> 22 (Riempie)
2025-11-12 11:50:33,722 - DEBUG - Aggiunta relazione: 24 -> 18 (Taglia)
2025-11-12 11:50:33,725 - DEBUG - Aggiunta relazione: 25 -> 24 (Riempie)
2025-11-12 11:50:33,728 - DEBUG - Aggiunta relazione: 26 -> 18 (Taglia)
2025-11-12 11:50:33,730 - DEBUG - Aggiunta relazione: 27 -> 26 (Riempie)
2025-11-12 11:50:33,732 - DEBUG - Aggiunta relazione: 28 -> 30 (Taglia)
2025-11-12 11:50:33,735 - DEBUG - Aggiunta relazione: 28 -> 32 (Taglia)
2025-11-12 11:50:33,737 - DEBUG - Aggiunta relazione: 28 -> 5 (Taglia)
2025-11-12 11:50:33,739 - DEBUG - Aggiunta relazione: 29 -> 31 (Copre)
2025-11-12 11:50:33,741 - DEBUG - Aggiunta relazione: 29 -> 33 (Copre)
2025-11-12 11:50:33,744 - DEBUG - Aggiunta relazione: 29 -> 34 (Copre)
2025-11-12 11:50:33,746 - DEBUG - Aggiunta relazione: 30 -> 18 (Copre)
2025-11-12 11:50:33,748 - DEBUG - Aggiunta relazione: 31 -> 33 (Copre)
2025-11-12 11:50:33,750 - DEBUG - Aggiunta relazione: 31 -> 34 (Copre)
2025-11-12 11:50:33,753 - DEBUG - Aggiunta relazione: 31 -> 35 (Copre)
2025-11-12 11:50:33,755 - DEBUG - Aggiunta relazione: 31 -> 36 (Copre)
2025-11-12 11:50:33,757 - DEBUG - Aggiunta relazione: 32 -> 29 (Copre)
2025-11-12 11:50:33,759 - DEBUG - Aggiunta relazione: 32 -> 6 (Si appoggia a)
2025-11-12 11:50:33,761 - DEBUG - Aggiunta relazione: 33 -> 35 (Copre)
2025-11-12 11:50:33,763 - DEBUG - Aggiunta relazione: 33 -> 36 (Copre)
2025-11-12 11:50:33,765 - DEBUG - Aggiunta relazione: 33 -> 38 (Copre)
2025-11-12 11:50:33,768 - DEBUG - Aggiunta relazione: 33 -> 37 (Riempie)
2025-11-12 11:50:33,770 - DEBUG - Aggiunta relazione: 34 -> 33 (Copre)
2025-11-12 11:50:33,772 - DEBUG - Aggiunta relazione: 34 -> 35 (Copre)
2025-11-12 11:50:33,774 - DEBUG - Aggiunta relazione: 34 -> 36 (Copre)
2025-11-12 11:50:33,776 - DEBUG - Aggiunta relazione: 35 -> 38 (Copre)
2025-11-12 11:50:33,778 - DEBUG - Aggiunta relazione: 35 -> 36 (Si appoggia a)
2025-11-12 11:50:33,780 - DEBUG - Aggiunta relazione: 36 -> 38 (Taglia)
2025-11-12 11:50:33,782 - DEBUG - Aggiunta relazione: 36 -> 39 (Taglia)
2025-11-12 11:50:33,785 - DEBUG - Aggiunta relazione: 37 -> 35 (Taglia)
2025-11-12 11:50:33,787 - DEBUG - Aggiunta relazione: 37 -> 36 (Taglia)
2025-11-12 11:50:33,789 - DEBUG - Aggiunta relazione: 37 -> 38 (Taglia)
2025-11-12 11:50:33,790 - DEBUG - Aggiunta relazione: 37 -> 39 (Taglia)
2025-11-12 11:50:33,793 - DEBUG - Aggiunta relazione: 39 -> 38 (Copre)
2025-11-12 11:50:33,795 - DEBUG - Aggiunta relazione: 104 -> 900 (>>)
2025-11-12 11:50:33,797 - DEBUG - Aggiunta relazione: 106 -> 400 (>>)
2025-11-12 11:50:33,799 - DEBUG - Aggiunta relazione: 106 -> 800 (>>)
2025-11-12 11:50:33,801 - DEBUG - Aggiunta relazione: 400 -> 4001 (>>)
2025-11-12 11:50:33,803 - DEBUG - Aggiunta relazione: 400 -> 4002 (>>)
2025-11-12 11:50:33,805 - DEBUG - Aggiunta relazione: 800 -> 400 (>>)
2025-11-12 11:50:33,818 - DEBUG - Aggiunta relazione: 900 -> 402 (>>)
2025-11-12 11:50:33,822 - DEBUG - Aggiunta relazione: 402 -> 29 (>>)
2025-11-12 11:50:33,824 - INFO - Grafo costruito: 51 nodi, 89 archi, 89 relazioni totali
2025-11-12 11:50:33,827 - INFO - Ricerca cicli nel grafo...
2025-11-12 11:50:33,830 - INFO - Nessun ciclo trovato nel grafo
2025-11-12 11:50:33,832 - INFO - Inizio calcolo sequenza stratigrafica...
2025-11-12 11:50:33,837 - INFO - Inizio calcolo sequenza stratigrafica...
2025-11-12 11:50:33,839 - INFO - DEBUG MAIN: Prima di chiamare topological_sort. all_us=51
2025-11-12 11:50:33,841 - INFO - US di base (senza predecessori): ['1', '102', '103', '104', '106', '300', '500']
2025-11-12 11:50:33,844 - DEBUG - Livello 0: 1, 102, 103, 104, 106, 300, 500
2025-11-12 11:50:33,847 - DEBUG - Livello 1: 8, 800, 900
2025-11-12 11:50:33,850 - DEBUG - Livello 2: 400, 402, 7
2025-11-12 11:50:33,853 - DEBUG - Livello 3: 2, 4001, 4002
2025-11-12 11:50:33,855 - DEBUG - Livello 4: 3
2025-11-12 11:50:33,858 - DEBUG - Livello 5: 10, 12, 14, 16, 9
2025-11-12 11:50:33,860 - DEBUG - Livello 6: 11, 13, 15
2025-11-12 11:50:33,863 - DEBUG - Livello 7: 4
2025-11-12 11:50:33,865 - DEBUG - Livello 8: 17, 20, 21, 23, 25, 27
2025-11-12 11:50:33,868 - DEBUG - Livello 9: 22, 24, 26, 28
2025-11-12 11:50:33,870 - DEBUG - Livello 10: 30
2025-11-12 11:50:33,872 - DEBUG - Livello 11: 18
2025-11-12 11:50:33,875 - DEBUG - Livello 12: 19, 5
2025-11-12 11:50:33,877 - DEBUG - Livello 13: 32
2025-11-12 11:50:33,879 - DEBUG - Livello 14: 29, 6
2025-11-12 11:50:33,881 - DEBUG - Livello 15: 31
2025-11-12 11:50:33,883 - DEBUG - Livello 16: 34
2025-11-12 11:50:33,885 - DEBUG - Livello 17: 33
2025-11-12 11:50:33,887 - DEBUG - Livello 18: 37
2025-11-12 11:50:33,889 - DEBUG - Livello 19: 35
2025-11-12 11:50:33,890 - DEBUG - Livello 20: 36
2025-11-12 11:50:33,892 - DEBUG - Livello 21: 39
2025-11-12 11:50:33,894 - DEBUG - Livello 22: 38
2025-11-12 11:50:33,896 - INFO - ================================================================================
2025-11-12 11:50:33,898 - INFO - GESTIONE ORDINE STRATIGRAFICO
2025-11-12 11:50:33,899 - INFO - ================================================================================
2025-11-12 11:50:33,901 - INFO - ORDINE ALGORITMO KAHN (base = US più recenti senza predecessori):
2025-11-12 11:50:33,903 - INFO -   Livello 0: [1, 102, 103, 104, 106, 300, 500]
2025-11-12 11:50:33,905 - INFO -   Livello 1: [8, 800, 900]
2025-11-12 11:50:33,907 - INFO -   Livello 2: [400, 402, 7]
2025-11-12 11:50:33,909 - INFO -   ...
2025-11-12 11:50:33,911 - INFO -   Livello 20: [36]
2025-11-12 11:50:33,912 - INFO -   Livello 21: [39]
2025-11-12 11:50:33,914 - INFO -   Livello 22: [38]
2025-11-12 11:50:33,916 - INFO - 
2025-11-12 11:50:33,917 - INFO - ORDINE FINALE INVERTITO (antico → recente):
2025-11-12 11:50:33,920 - INFO -   Livello 0: [38] <- Più antiche
2025-11-12 11:50:33,922 - INFO -   Livello 1: [39] <- 
2025-11-12 11:50:33,924 - INFO -   Livello 2: [36] <- 
2025-11-12 11:50:33,925 - INFO -   ...
2025-11-12 11:50:33,927 - INFO -   Livello 20: [400, 402, 7] <- 
2025-11-12 11:50:33,929 - INFO -   Livello 21: [8, 800, 900] <- 
2025-11-12 11:50:33,930 - INFO -   Livello 22: [1, 102, 103, 104, 106, 300, 500] <- Più recenti
2025-11-12 11:50:33,932 - INFO - ================================================================================
2025-11-12 11:50:33,934 - INFO - DEBUG MAIN: Dopo topological_sort. levels type=<class 'list'>, is None=False
2025-11-12 11:50:33,936 - INFO - DEBUG MAIN: levels length=23
2025-11-12 11:50:33,938 - INFO - DEBUG MAIN: generated_levels exists, length=0
2025-11-12 11:50:33,940 - INFO - Matrix generato con successo: 23 livelli
2025-11-12 11:50:33,942 - INFO - Preparazione risultati finali...
2025-11-12 11:50:33,945 - INFO - Matrix completato: 23 livelli, 51 US
2025-11-12 11:50:33,946 - INFO - === RISULTATI FINALI ===
2025-11-12 11:50:33,948 - INFO - Livello 0: 38
2025-11-12 11:50:33,950 - INFO - Livello 1: 39
2025-11-12 11:50:33,952 - INFO - Livello 2: 36
2025-11-12 11:50:33,954 - INFO - Livello 3: 35
2025-11-12 11:50:33,955 - INFO - Livello 4: 37
2025-11-12 11:50:33,957 - INFO - Livello 5: 33
2025-11-12 11:50:33,958 - INFO - Livello 6: 34
2025-11-12 11:50:33,960 - INFO - Livello 7: 31
2025-11-12 11:50:33,962 - INFO - Livello 8: 29, 6
2025-11-12 11:50:33,964 - INFO - Livello 9: 32
2025-11-12 11:50:33,965 - INFO - Livello 10: 19, 5
2025-11-12 11:50:33,967 - INFO - Livello 11: 18
2025-11-12 11:50:33,969 - INFO - Livello 12: 30
2025-11-12 11:50:33,970 - INFO - Livello 13: 22, 24, 26, 28
2025-11-12 11:50:33,972 - INFO - Livello 14: 17, 20, 21, 23, 25, 27
2025-11-12 11:50:33,974 - INFO - Livello 15: 4
2025-11-12 11:50:33,975 - INFO - Livello 16: 11, 13, 15
2025-11-12 11:50:33,977 - INFO - Livello 17: 10, 12, 14, 16, 9
2025-11-12 11:50:33,978 - INFO - Livello 18: 3
2025-11-12 11:50:33,980 - INFO - Livello 19: 2, 4001, 4002
2025-11-12 11:50:33,981 - INFO - Livello 20: 400, 402, 7
2025-11-12 11:50:33,983 - INFO - Livello 21: 8, 800, 900
2025-11-12 11:50:33,984 - INFO - Livello 22: 1, 102, 103, 104, 106, 300, 500
2025-11-12 11:50:33,986 - INFO - Matrix calcolato con successo. Pronto per aggiornamento database.
2025-11-12 11:50:33,989 - INFO - === INIZIO AGGIORNAMENTO DATABASE ===
2025-11-12 11:50:33,992 - DEBUG - Aggiornamento livello 0: 1 US
2025-11-12 11:50:34,032 - DEBUG - Aggiornamento livello 1: 1 US
2025-11-12 11:50:34,066 - DEBUG - Aggiornamento livello 2: 1 US
2025-11-12 11:50:34,100 - DEBUG - Aggiornamento livello 3: 1 US
2025-11-12 11:50:34,134 - DEBUG - Aggiornamento livello 4: 1 US
2025-11-12 11:50:34,168 - DEBUG - Aggiornamento livello 5: 1 US
2025-11-12 11:50:34,202 - DEBUG - Aggiornamento livello 6: 1 US
2025-11-12 11:50:34,236 - DEBUG - Aggiornamento livello 7: 1 US
2025-11-12 11:50:34,269 - DEBUG - Aggiornamento livello 8: 2 US
2025-11-12 11:50:34,334 - DEBUG - Aggiornate 10 US...
2025-11-12 11:50:34,337 - DEBUG - Aggiornamento livello 9: 1 US
2025-11-12 11:50:34,370 - DEBUG - Aggiornamento livello 10: 2 US
2025-11-12 11:50:34,435 - DEBUG - Aggiornamento livello 11: 1 US
2025-11-12 11:50:34,471 - DEBUG - Aggiornamento livello 12: 1 US
2025-11-12 11:50:34,506 - DEBUG - Aggiornamento livello 13: 4 US
2025-11-12 11:50:34,636 - DEBUG - Aggiornamento livello 14: 6 US
2025-11-12 11:50:34,674 - DEBUG - Aggiornate 20 US...
2025-11-12 11:50:35,473 - DEBUG - Aggiornamento livello 15: 1 US
2025-11-12 11:50:35,641 - DEBUG - Aggiornamento livello 16: 3 US
2025-11-12 11:50:36,134 - DEBUG - Aggiornamento livello 17: 5 US
2025-11-12 11:50:36,304 - DEBUG - Aggiornate 30 US...
2025-11-12 11:50:36,969 - DEBUG - Aggiornamento livello 18: 1 US
2025-11-12 11:50:37,141 - DEBUG - Aggiornamento livello 19: 3 US
2025-11-12 11:50:37,638 - DEBUG - Aggiornamento livello 20: 3 US
2025-11-12 11:50:37,968 - DEBUG - Aggiornate 40 US...
2025-11-12 11:50:38,136 - DEBUG - Aggiornamento livello 21: 3 US
2025-11-12 11:50:38,625 - DEBUG - Aggiornamento livello 22: 7 US
2025-11-12 11:50:39,608 - DEBUG - Aggiornate 50 US...
2025-11-12 11:50:39,778 - INFO - === AGGIORNAMENTO COMPLETATO ===
2025-11-12 11:50:39,782 - INFO - US aggiornate: 51
