2025-06-30 11:09:03,452 - INFO - Inizializzazione Order_layer_graph per Scavo archeologico - 1
2025-06-30 11:09:03,821 - INFO - Avvio caricamento dati dal database...
2025-06-30 11:09:03,843 - INFO - Tipo database rilevato: SQLite
2025-06-30 11:09:03,864 - DEBUG - Esecuzione query: 
            SELECT us, rapporti 
            FROM us_table 
            WHERE sito = 'Scavo archeologico' AND area = '1'
            
2025-06-30 11:09:03,920 - DEBUG - Caricate 50 US...
2025-06-30 11:09:03,974 - INFO - Completato: caricate 51 US dal database
2025-06-30 11:09:03,978 - INFO - Costruzione del grafo stratigrafico...
2025-06-30 11:09:03,983 - DEBUG - Aggiunta relazione: 2 -> 1 (Copre)
2025-06-30 11:09:03,993 - DEBUG - Aggiunta relazione: 8 -> 1 (Copre)
2025-06-30 11:09:03,997 - DEBUG - Aggiunta relazione: 3 -> 2 (Copre)
2025-06-30 11:09:03,998 - DEBUG - Aggiunta relazione: 555 -> 2 (Copre)
2025-06-30 11:09:04,000 - DEBUG - Aggiunta relazione: 10 -> 3 (Copre)
2025-06-30 11:09:04,001 - DEBUG - Aggiunta relazione: 11 -> 3 (Copre)
2025-06-30 11:09:04,002 - DEBUG - Aggiunta relazione: 12 -> 3 (Copre)
2025-06-30 11:09:04,002 - DEBUG - Aggiunta relazione: 14 -> 3 (Copre)
2025-06-30 11:09:04,011 - DEBUG - Aggiunta relazione: 16 -> 3 (Copre)
2025-06-30 11:09:04,014 - DEBUG - Aggiunta relazione: 4 -> 3 (Copre)
2025-06-30 11:09:04,015 - DEBUG - Aggiunta relazione: 5 -> 3 (Copre)
2025-06-30 11:09:04,016 - DEBUG - Aggiunta relazione: 6 -> 3 (Copre)
2025-06-30 11:09:04,016 - DEBUG - Aggiunta relazione: 9 -> 3 (Copre)
2025-06-30 11:09:04,017 - DEBUG - Aggiunta relazione: 17 -> 4 (Copre)
2025-06-30 11:09:04,018 - DEBUG - Aggiunta relazione: 18 -> 4 (Copre)
2025-06-30 11:09:04,018 - DEBUG - Aggiunta relazione: 19 -> 4 (Copre)
2025-06-30 11:09:04,019 - DEBUG - Aggiunta relazione: 20 -> 4 (Copre)
2025-06-30 11:09:04,027 - DEBUG - Aggiunta relazione: 23 -> 4 (Copre)
2025-06-30 11:09:04,030 - DEBUG - Aggiunta relazione: 25 -> 4 (Copre)
2025-06-30 11:09:04,036 - DEBUG - Aggiunta relazione: 27 -> 4 (Copre)
2025-06-30 11:09:04,040 - DEBUG - Aggiunta relazione: 5 -> 4 (Copre)
2025-06-30 11:09:04,043 - DEBUG - Aggiunta relazione: 21 -> 4 (Riempie)
2025-06-30 11:09:04,046 - DEBUG - Aggiunta relazione: 555 -> 4 (Si appoggia a)
2025-06-30 11:09:04,057 - DEBUG - Aggiunta relazione: 6 -> 4 (Si appoggia a)
2025-06-30 11:09:04,061 - DEBUG - Aggiunta relazione: 29 -> 5 (Copre)
2025-06-30 11:09:04,072 - DEBUG - Aggiunta relazione: 32 -> 5 (Copre)
2025-06-30 11:09:04,077 - DEBUG - Aggiunta relazione: 6 -> 5 (Si appoggia a)
2025-06-30 11:09:04,088 - DEBUG - Aggiunta relazione: 2 -> 7 (Taglia)
2025-06-30 11:09:04,092 - DEBUG - Aggiunta relazione: 7 -> 8 (Riempie)
2025-06-30 11:09:04,095 - DEBUG - Aggiunta relazione: 4 -> 9 (Copre)
2025-06-30 11:09:04,106 - DEBUG - Aggiunta relazione: 11 -> 10 (Copre)
2025-06-30 11:09:04,111 - DEBUG - Aggiunta relazione: 4 -> 11 (Copre)
2025-06-30 11:09:04,122 - DEBUG - Aggiunta relazione: 6 -> 12 (Si appoggia a)
2025-06-30 11:09:04,128 - DEBUG - Aggiunta relazione: 18 -> 13 (Taglia)
2025-06-30 11:09:04,131 - DEBUG - Aggiunta relazione: 4 -> 13 (Taglia)
2025-06-30 11:09:04,134 - DEBUG - Aggiunta relazione: 13 -> 14 (Riempie)
2025-06-30 11:09:04,136 - DEBUG - Aggiunta relazione: 4 -> 15 (Taglia)
2025-06-30 11:09:04,140 - DEBUG - Aggiunta relazione: 15 -> 16 (Riempie)
2025-06-30 11:09:04,143 - DEBUG - Aggiunta relazione: 30 -> 17 (Copre)
2025-06-30 11:09:04,146 - DEBUG - Aggiunta relazione: 5 -> 17 (Copre)
2025-06-30 11:09:04,157 - DEBUG - Aggiunta relazione: 28 -> 17 (Riempie)
2025-06-30 11:09:04,162 - DEBUG - Aggiunta relazione: 29 -> 18 (Copre)
2025-06-30 11:09:04,173 - DEBUG - Aggiunta relazione: 31 -> 18 (Copre)
2025-06-30 11:09:04,178 - DEBUG - Aggiunta relazione: 19 -> 18 (Si appoggia a)
2025-06-30 11:09:04,181 - DEBUG - Aggiunta relazione: 5 -> 18 (Si appoggia a)
2025-06-30 11:09:04,184 - DEBUG - Aggiunta relazione: 6 -> 18 (Si appoggia a)
2025-06-30 11:09:04,187 - DEBUG - Aggiunta relazione: 19 -> 20 (Si appoggia a)
2025-06-30 11:09:04,190 - DEBUG - Aggiunta relazione: 18 -> 21 (Taglia)
2025-06-30 11:09:04,193 - DEBUG - Aggiunta relazione: 18 -> 22 (Taglia)
2025-06-30 11:09:04,196 - DEBUG - Aggiunta relazione: 22 -> 23 (Riempie)
2025-06-30 11:09:04,208 - DEBUG - Aggiunta relazione: 18 -> 24 (Taglia)
2025-06-30 11:09:04,212 - DEBUG - Aggiunta relazione: 24 -> 25 (Riempie)
2025-06-30 11:09:04,215 - DEBUG - Aggiunta relazione: 18 -> 26 (Taglia)
2025-06-30 11:09:04,218 - DEBUG - Aggiunta relazione: 26 -> 27 (Riempie)
2025-06-30 11:09:04,220 - DEBUG - Aggiunta relazione: 30 -> 28 (Taglia)
2025-06-30 11:09:04,224 - DEBUG - Aggiunta relazione: 32 -> 28 (Taglia)
2025-06-30 11:09:04,227 - DEBUG - Aggiunta relazione: 5 -> 28 (Taglia)
2025-06-30 11:09:04,238 - DEBUG - Aggiunta relazione: 31 -> 29 (Copre)
2025-06-30 11:09:04,243 - DEBUG - Aggiunta relazione: 33 -> 29 (Copre)
2025-06-30 11:09:04,246 - DEBUG - Aggiunta relazione: 34 -> 29 (Copre)
2025-06-30 11:09:04,257 - DEBUG - Aggiunta relazione: 18 -> 30 (Copre)
2025-06-30 11:09:04,262 - DEBUG - Aggiunta relazione: 33 -> 31 (Copre)
2025-06-30 11:09:04,266 - DEBUG - Aggiunta relazione: 34 -> 31 (Copre)
2025-06-30 11:09:04,269 - DEBUG - Aggiunta relazione: 35 -> 31 (Copre)
2025-06-30 11:09:04,271 - DEBUG - Aggiunta relazione: 36 -> 31 (Copre)
2025-06-30 11:09:04,276 - DEBUG - Aggiunta relazione: 29 -> 32 (Copre)
2025-06-30 11:09:04,280 - DEBUG - Aggiunta relazione: 6 -> 32 (Si appoggia a)
2025-06-30 11:09:04,284 - DEBUG - Aggiunta relazione: 35 -> 33 (Copre)
2025-06-30 11:09:04,286 - DEBUG - Aggiunta relazione: 36 -> 33 (Copre)
2025-06-30 11:09:04,289 - DEBUG - Aggiunta relazione: 38 -> 33 (Copre)
2025-06-30 11:09:04,292 - DEBUG - Aggiunta relazione: 37 -> 33 (Riempie)
2025-06-30 11:09:04,296 - DEBUG - Aggiunta relazione: 33 -> 34 (Copre)
2025-06-30 11:09:04,307 - DEBUG - Aggiunta relazione: 35 -> 34 (Copre)
2025-06-30 11:09:04,313 - DEBUG - Aggiunta relazione: 36 -> 34 (Copre)
2025-06-30 11:09:04,318 - DEBUG - Aggiunta relazione: 38 -> 35 (Copre)
2025-06-30 11:09:04,322 - DEBUG - Aggiunta relazione: 36 -> 35 (Si appoggia a)
2025-06-30 11:09:04,327 - DEBUG - Aggiunta relazione: 38 -> 36 (Taglia)
2025-06-30 11:09:04,339 - DEBUG - Aggiunta relazione: 39 -> 36 (Taglia)
2025-06-30 11:09:04,344 - DEBUG - Aggiunta relazione: 35 -> 37 (Taglia)
2025-06-30 11:09:04,348 - DEBUG - Aggiunta relazione: 36 -> 37 (Taglia)
2025-06-30 11:09:04,351 - DEBUG - Aggiunta relazione: 38 -> 37 (Taglia)
2025-06-30 11:09:04,354 - DEBUG - Aggiunta relazione: 39 -> 37 (Taglia)
2025-06-30 11:09:04,357 - DEBUG - Aggiunta relazione: 38 -> 39 (Copre)
2025-06-30 11:09:04,361 - DEBUG - Aggiunta relazione: 900 -> 104 (>>)
2025-06-30 11:09:04,373 - DEBUG - Aggiunta relazione: 400 -> 106 (>>)
2025-06-30 11:09:04,379 - DEBUG - Aggiunta relazione: 800 -> 106 (>>)
2025-06-30 11:09:04,382 - DEBUG - Aggiunta relazione: 4001 -> 400 (>>)
2025-06-30 11:09:04,385 - DEBUG - Aggiunta relazione: 4002 -> 400 (>>)
2025-06-30 11:09:04,397 - DEBUG - Aggiunta relazione: 29 -> 402 (>>)
2025-06-30 11:09:04,404 - DEBUG - Aggiunta relazione: 400 -> 800 (>>)
2025-06-30 11:09:04,408 - DEBUG - Aggiunta relazione: 402 -> 900 (>>)
2025-06-30 11:09:04,411 - INFO - Grafo costruito: 52 nodi, 91 archi, 91 relazioni totali
2025-06-30 11:09:04,423 - INFO - Ricerca cicli nel grafo...
2025-06-30 11:09:04,429 - INFO - Nessun ciclo trovato nel grafo
2025-06-30 11:09:04,434 - INFO - Inizio calcolo sequenza stratigrafica...
2025-06-30 11:09:04,438 - INFO - Inizio calcolo sequenza stratigrafica...
2025-06-30 11:09:04,442 - INFO - DEBUG MAIN: Prima di chiamare topological_sort. all_us=52
2025-06-30 11:09:04,445 - INFO - US di base (senza predecessori): ['102', '103', '19', '300', '38', '4001', '4002', '500', '555', '6']
2025-06-30 11:09:04,457 - DEBUG - Livello 0: 102, 103, 19, 300, 38, 4001, 4002, 500, 555, 6
2025-06-30 11:09:04,464 - DEBUG - Livello 1: 12, 20, 39, 400
2025-06-30 11:09:04,468 - DEBUG - Livello 2: 36, 800
2025-06-30 11:09:04,484 - DEBUG - Livello 3: 106, 35
2025-06-30 11:09:04,498 - DEBUG - Livello 4: 37
2025-06-30 11:09:04,502 - DEBUG - Livello 5: 33
2025-06-30 11:09:04,506 - DEBUG - Livello 6: 34
2025-06-30 11:09:04,510 - DEBUG - Livello 7: 31
2025-06-30 11:09:04,516 - DEBUG - Livello 8: 29
2025-06-30 11:09:04,521 - DEBUG - Livello 9: 32, 402
2025-06-30 11:09:04,527 - DEBUG - Livello 10: 5, 900
2025-06-30 11:09:04,530 - DEBUG - Livello 11: 104, 18
2025-06-30 11:09:04,544 - DEBUG - Livello 12: 21, 22, 24, 26, 30
2025-06-30 11:09:04,548 - DEBUG - Livello 13: 23, 25, 27, 28
2025-06-30 11:09:04,552 - DEBUG - Livello 14: 17
2025-06-30 11:09:04,567 - DEBUG - Livello 15: 4
2025-06-30 11:09:04,579 - DEBUG - Livello 16: 11, 13, 15, 9
2025-06-30 11:09:04,583 - DEBUG - Livello 17: 10, 14, 16
2025-06-30 11:09:04,586 - DEBUG - Livello 18: 3
2025-06-30 11:09:04,589 - DEBUG - Livello 19: 2
2025-06-30 11:09:04,592 - DEBUG - Livello 20: 7
2025-06-30 11:09:04,595 - DEBUG - Livello 21: 8
2025-06-30 11:09:04,608 - DEBUG - Livello 22: 1
2025-06-30 11:09:04,611 - INFO - DEBUG MAIN: Dopo topological_sort. levels type=<class 'list'>, is None=False
2025-06-30 11:09:04,614 - INFO - DEBUG MAIN: levels length=23
2025-06-30 11:09:04,616 - INFO - DEBUG MAIN: generated_levels exists, length=0
2025-06-30 11:09:04,618 - INFO - Matrix generato con successo: 23 livelli
2025-06-30 11:09:04,621 - INFO - Preparazione risultati finali...
2025-06-30 11:09:04,625 - INFO - Matrix completato: 23 livelli, 52 US
2025-06-30 11:09:04,628 - INFO - === RISULTATI FINALI ===
2025-06-30 11:09:04,638 - INFO - Livello 0: 102, 103, 19, 300, 38, 4001, 4002, 500, 555, 6
2025-06-30 11:09:04,644 - INFO - Livello 1: 12, 20, 39, 400
2025-06-30 11:09:04,655 - INFO - Livello 2: 36, 800
2025-06-30 11:09:04,661 - INFO - Livello 3: 106, 35
2025-06-30 11:09:04,664 - INFO - Livello 4: 37
2025-06-30 11:09:04,667 - INFO - Livello 5: 33
2025-06-30 11:09:04,669 - INFO - Livello 6: 34
2025-06-30 11:09:04,672 - INFO - Livello 7: 31
2025-06-30 11:09:04,675 - INFO - Livello 8: 29
2025-06-30 11:09:04,678 - INFO - Livello 9: 32, 402
2025-06-30 11:09:04,689 - INFO - Livello 10: 5, 900
2025-06-30 11:09:04,694 - INFO - Livello 11: 104, 18
2025-06-30 11:09:04,697 - INFO - Livello 12: 21, 22, 24, 26, 30
2025-06-30 11:09:04,699 - INFO - Livello 13: 23, 25, 27, 28
2025-06-30 11:09:04,702 - INFO - Livello 14: 17
2025-06-30 11:09:04,704 - INFO - Livello 15: 4
2025-06-30 11:09:04,708 - INFO - Livello 16: 11, 13, 15, 9
2025-06-30 11:09:04,710 - INFO - Livello 17: 10, 14, 16
2025-06-30 11:09:04,721 - INFO - Livello 18: 3
2025-06-30 11:09:04,726 - INFO - Livello 19: 2
2025-06-30 11:09:04,729 - INFO - Livello 20: 7
2025-06-30 11:09:04,740 - INFO - Livello 21: 8
2025-06-30 11:09:04,745 - INFO - Livello 22: 1
2025-06-30 11:09:04,748 - INFO - Matrix calcolato con successo. Pronto per aggiornamento database.
2025-06-30 11:09:04,751 - INFO - === INIZIO AGGIORNAMENTO DATABASE ===
2025-06-30 11:09:04,756 - DEBUG - Aggiornamento livello 0: 10 US
2025-06-30 11:09:06,328 - WARNING - Nessun record trovato per US 555
2025-06-30 11:09:06,528 - DEBUG - Aggiornamento livello 1: 4 US
2025-06-30 11:09:06,725 - DEBUG - Aggiornate 10 US...
2025-06-30 11:09:07,270 - DEBUG - Aggiornamento livello 2: 2 US
2025-06-30 11:09:07,643 - DEBUG - Aggiornamento livello 3: 2 US
2025-06-30 11:09:08,012 - DEBUG - Aggiornamento livello 4: 1 US
2025-06-30 11:09:08,202 - DEBUG - Aggiornamento livello 5: 1 US
2025-06-30 11:09:08,392 - DEBUG - Aggiornamento livello 6: 1 US
2025-06-30 11:09:08,585 - DEBUG - Aggiornate 20 US...
2025-06-30 11:09:08,590 - DEBUG - Aggiornamento livello 7: 1 US
2025-06-30 11:09:08,779 - DEBUG - Aggiornamento livello 8: 1 US
2025-06-30 11:09:08,967 - DEBUG - Aggiornamento livello 9: 2 US
2025-06-30 11:09:09,338 - DEBUG - Aggiornamento livello 10: 2 US
2025-06-30 11:09:09,707 - DEBUG - Aggiornamento livello 11: 2 US
2025-06-30 11:09:10,062 - DEBUG - Aggiornamento livello 12: 5 US
2025-06-30 11:09:10,414 - DEBUG - Aggiornate 30 US...
2025-06-30 11:09:10,943 - DEBUG - Aggiornamento livello 13: 4 US
2025-06-30 11:09:11,643 - DEBUG - Aggiornamento livello 14: 1 US
2025-06-30 11:09:11,822 - DEBUG - Aggiornamento livello 15: 1 US
2025-06-30 11:09:12,001 - DEBUG - Aggiornamento livello 16: 4 US
2025-06-30 11:09:12,182 - DEBUG - Aggiornate 40 US...
2025-06-30 11:09:12,710 - DEBUG - Aggiornamento livello 17: 3 US
2025-06-30 11:09:13,239 - DEBUG - Aggiornamento livello 18: 1 US
2025-06-30 11:09:13,417 - DEBUG - Aggiornamento livello 19: 1 US
2025-06-30 11:09:13,601 - DEBUG - Aggiornamento livello 20: 1 US
2025-06-30 11:09:13,783 - DEBUG - Aggiornamento livello 21: 1 US
2025-06-30 11:09:13,966 - DEBUG - Aggiornate 50 US...
2025-06-30 11:09:13,971 - DEBUG - Aggiornamento livello 22: 1 US
2025-06-30 11:09:14,155 - INFO - === AGGIORNAMENTO COMPLETATO ===
2025-06-30 11:09:14,159 - INFO - US aggiornate: 51
2025-06-30 11:09:14,161 - WARNING - Errori riscontrati: 1
