# PyArchInit - بطاقة الوحدة الطبقية US/USM

## الفهرس
1. [المقدمة](#المقدمة)
2. [المفاهيم الأساسية](#المفاهيم-الأساسية)
3. [الوصول إلى البطاقة](#الوصول-إلى-البطاقة)
4. [الواجهة العامة](#الواجهة-العامة)
5. [حقول التعريف](#حقول-التعريف)
6. [تبويب الموقع](#تبويب-الموقع)
7. [تبويب البيانات الوصفية](#تبويب-البيانات-الوصفية)
8. [تبويب التأريخ](#تبويب-التأريخ)
9. [تبويب العلاقات الطبقية](#تبويب-العلاقات-الطبقية)
10. [تبويب البيانات الفيزيائية](#تبويب-البيانات-الفيزيائية)
11. [تبويب القياسات](#تبويب-القياسات)
12. [تبويب التوثيق](#تبويب-التوثيق)
13. [تبويب التقنية البنائية USM](#تبويب-التقنية-البنائية-usm)
14. [تبويب الوسائط](#تبويب-الوسائط)
15. [مصفوفة هاريس](#مصفوفة-هاريس)
16. [وظائف GIS](#وظائف-gis)
17. [التصدير](#التصدير)
18. [سير العمل التشغيلي](#سير-العمل-التشغيلي)

---

## المقدمة

**بطاقة الوحدة الطبقية US/USM** (Unità Stratigrafica / Unità Stratigrafica Muraria) هي قلب التوثيق الأثري في PyArchInit. تمثل الأداة الرئيسية لتسجيل جميع المعلومات المتعلقة بالوحدات الطبقية المحددة أثناء الحفر.

تطبق هذه البطاقة مبادئ **المنهج الطبقي** الذي طوره إدوارد سي. هاريس، مما يسمح بتوثيق:
- الخصائص الفيزيائية لكل طبقة
- العلاقات الطبقية بين الوحدات
- التأريخ النسبي والمطلق
- التوثيق الرسومي والفوتوغرافي المرتبط

> **فيديو تعليمي**: [رابط فيديو مقدمة بطاقة الوحدة الطبقية]

---

## المفاهيم الأساسية

### ما هي الوحدة الطبقية (US)

**الوحدة الطبقية** هي أصغر وحدة حفر يمكن تحديدها وتمييزها عن غيرها. يمكن أن تكون:
- **طبقة**: رواسب تراب بخصائص متجانسة
- **سطح بيني**: سطح تلامس بين الطبقات (مثل قطع حفرة)
- **عنصر هيكلي**: جزء من بناء

### أنواع الوحدات

| النوع | الرمز | الوصف |
|-------|-------|--------|
| US | وحدة طبقية | طبقة عامة |
| USM | وحدة طبقية جدارية | عنصر بناء جداري |
| USVA | وحدة طبقية عمودية أ | مرتفع عمودي نوع أ |
| USVB | وحدة طبقية عمودية ب | مرتفع عمودي نوع ب |
| USD | وحدة طبقية هدم | طبقة انهيار/هدم |
| CON | قطع حجرية | كتل معمارية |
| VSF | ميزة طبقية افتراضية | عنصر افتراضي |
| SF | ميزة طبقية | ميزة طبقية |
| SUS | وحدة طبقية فرعية | تقسيم فرعي للوحدة الطبقية |

### العلاقات الطبقية

تحدد العلاقات الطبقية العلاقات الزمنية بين الوحدات الطبقية:

| العلاقة | العكس | المعنى |
|---------|-------|--------|
| **يغطي** | مغطى بـ | الوحدة الطبقية تتراكب فيزيائياً |
| **يقطع** | مقطوع بـ | الوحدة الطبقية تقاطع/تخترق |
| **يملأ** | ممتلئ بـ | الوحدة الطبقية تملأ تجويفاً |
| **يستند إلى** | يستند إليه | علاقة استناد |

---

## الوصول إلى البطاقة

للوصول إلى بطاقة الوحدة الطبقية:

1. قائمة **PyArchInit** ← **Archaeological record management** ← **SU/WSU**
2. أو من شريط أدوات PyArchInit، انقر على أيقونة **US/USM**

---

## الواجهة العامة

بطاقة الوحدة الطبقية منظمة في عدة مناطق وظيفية:

### المناطق الرئيسية

| # | المنطقة | الوصف |
|---|--------|--------|
| 1 | **حقول التعريف** | الموقع، المنطقة، الوحدة الطبقية، النوع، التعريفات |
| 2 | **شريط أدوات DBMS** | التنقل، الحفظ، البحث |
| 3 | **تبويبات البيانات** | بطاقات موضوعية للبيانات |
| 4 | **شريط أدوات GIS** | أدوات عرض الخريطة |
| 5 | **تبويب صندوق الأدوات** | أدوات متقدمة ومصفوفة |

### شريط أدوات DBMS

| الزر | الوظيفة | الوصف |
|------|---------|--------|
| **New record** | جديد | إنشاء بطاقة وحدة طبقية جديدة |
| **Save** | حفظ | حفظ التعديلات |
| **Delete** | حذف | حذف البطاقة الحالية |
| **View all** | عرض الكل | عرض جميع السجلات |
| **First/Prev/Next/Last** | التنقل | التنقل بين السجلات |
| **new search** | بحث | بدء وضع البحث |
| **search !!!** | تنفيذ | تنفيذ البحث |
| **Order by** | ترتيب | ترتيب السجلات |
| **Report** | طباعة | إنشاء تقرير PDF |

---

## حقول التعريف

حقول التعريف مرئية دائماً في الجزء العلوي من البطاقة.

### الحقول الإلزامية

| الحقل | الوصف | الصيغة |
|-------|--------|--------|
| **الموقع** | اسم الموقع الأثري | نص (من قائمة منسدلة) |
| **المنطقة** | رقم منطقة الحفر | عدد صحيح (1-20) |
| **US/USM** | رقم الوحدة الطبقية | عدد صحيح |
| **نوع الوحدة** | نوع الوحدة (US، USM، إلخ) | اختيار |

### الحقول الوصفية

| الحقل | الوصف |
|-------|--------|
| **التعريف الطبقي** | التصنيف الطبقي (من القاموس) |
| **التعريف التفسيري** | التفسير الوظيفي (من القاموس) |

### أمثلة التعريفات الطبقية

| التعريف | الوصف |
|---------|--------|
| طبقة | رواسب عامة |
| ملء | مادة ردم |
| قطع | سطح بيني سالب |
| سطح استخدام | سطح مداس |
| انهيار | مادة منهارة |
| أرضية مدكوكة | رصف من تراب مدكوك |

### أمثلة التعريفات التفسيرية

| التعريف | الوصف |
|---------|--------|
| نشاط بناء | مرحلة بناء |
| هجر | مرحلة هجر |
| رصف | سطح أرضي |
| جدار | هيكل جداري |
| حفرة | حفر متعمد |
| تسوية | طبقة تحضيرية |

---

## تبويب الموقع

يحتوي على بيانات التموضع داخل الحفر.

### حقول الموقع

| الحقل | الوصف | ملاحظات |
|-------|--------|---------|
| **القطاع** | قطاع الحفر | حروف A-H أو أرقام 1-20 |
| **المربع/الجدار** | مرجع مكاني | للحفريات الشبكية |
| **الغرفة** | رقم الغرفة | للمباني/الهياكل |
| **الحفرة التجريبية** | رقم الحفرة التجريبية | للحفر التحقيقية |

### أرقام الفهرس

| الحقل | الوصف |
|-------|--------|
| **رقم الفهرس العام** | رقم الفهرس العام |
| **رقم الفهرس الداخلي** | رقم الفهرس الداخلي |
| **رقم الفهرس الدولي** | الرمز الدولي |

---

## تبويب البيانات الوصفية

يحتوي على الوصف النصي للوحدة الطبقية.

### الحقول الوصفية

| الحقل | الوصف | اقتراحات |
|-------|--------|----------|
| **الوصف** | الوصف الفيزيائي للوحدة الطبقية | اللون، القوام، التركيب، الحدود |
| **التفسير** | التفسير الوظيفي | الوظيفة، التكوين، المعنى |
| **عناصر التأريخ** | مواد للتأريخ | الفخار، العملات، القطع المؤرخة |
| **الملاحظات** | ملاحظات إضافية | شكوك، فرضيات، مقارنات |

### كيفية وصف الوحدة الطبقية

**الوصف الفيزيائي:**
```
طبقة من التراب الطيني، بني داكن اللون (10YR 3/3)،
قوام مضغوط، مع شوائب من قطع الطوب (2-5 سم)،
حصى كلسي (1-3 سم) وفحم. حدود واضحة من الأعلى،
متدرجة من الأسفل. سمك متغير 15-25 سم.
```

**التفسير:**
```
طبقة هجر تشكلت بعد توقف الأنشطة في الغرفة.
وجود المواد البنائية المتفتتة يشير إلى انهيار
جزئي للهياكل.
```

---

## تبويب التأريخ

يدير التسلسل الزمني للوحدة الطبقية.

### التأريخ النسبي

| الحقل | الوصف |
|-------|--------|
| **الفترة الأولية** | فترة التكوين |
| **المرحلة الأولية** | مرحلة التكوين |
| **الفترة النهائية** | فترة الإزالة |
| **المرحلة النهائية** | مرحلة الإزالة |

**ملاحظة**: يجب إنشاء الفترات والمراحل أولاً في **بطاقة التأريخ**.

### التأريخ المطلق

| الحقل | الوصف |
|-------|--------|
| **التأريخ** | تاريخ مطلق أو نطاق |
| **السنة** | سنة الحفر |

### حقول أخرى

| الحقل | الوصف | القيم |
|-------|--------|-------|
| **النشاط** | نوع النشاط | نص حر |
| **الهيكل** | رمز الهيكل المرتبط | من بطاقة الهيكل |
| **محفور** | حالة الحفر | نعم / لا |
| **طريقة الحفر** | طريقة الحفر | آلي / طبقي |

---

## تبويب العلاقات الطبقية

**هذا هو أهم تبويب في بطاقة الوحدة الطبقية.** يحدد العلاقات الطبقية مع الوحدات الأخرى.

> **فيديو تعليمي**: [رابط فيديو العلاقات الطبقية]

### هيكل جدول العلاقات

| العمود | الوصف |
|--------|--------|
| **الموقع** | موقع الوحدة الطبقية المرتبطة |
| **المنطقة** | منطقة الوحدة الطبقية المرتبطة |
| **US** | رقم الوحدة الطبقية المرتبطة |
| **نوع العلاقة** | نوع العلاقة |

### أنواع العلاقات المتاحة

| العربية | الإيطالية | الإنجليزية |
|---------|-----------|------------|
| يغطي | Copre | Covers |
| مغطى بـ | Coperto da | Covered by |
| يقطع | Taglia | Cuts |
| مقطوع بـ | Tagliato da | Cut by |
| يملأ | Riempie | Fills |
| ممتلئ بـ | Riempito da | Filled by |
| يستند إلى | Si appoggia a | Abuts |
| يستند إليه | Gli si appoggia | Supports |
| يساوي (=) | Uguale a | Same as |
| أقدم (>>) | Anteriore | Earlier |
| أحدث (<<) | Posteriore | Later |

### إدخال العلاقات

1. انقر على **+** لإضافة صف
2. أدخل الموقع، المنطقة، رقم الوحدة الطبقية المرتبطة
3. اختر نوع العلاقة
4. احفظ

### أزرار العلاقات

| الزر | الوظيفة |
|------|---------|
| **+** | إضافة صف |
| **-** | إزالة صف |
| **Insert or update inverse relat.** | إنشاء العلاقة العكسية تلقائياً |
| **اذهب إلى US** | التنقل إلى الوحدة الطبقية المحددة |
| **عرض المصفوفة** | عرض مصفوفة هاريس |
| **Fix** | تصحيح أخطاء العلاقات |

### العلاقات العكسية التلقائية

عند إدخال علاقة، يمكنك إنشاء العكس تلقائياً:

| إذا أدخلت | يتم إنشاء |
|-----------|----------|
| US 1 **يغطي** US 2 | US 2 **مغطى بـ** US 1 |
| US 1 **يقطع** US 2 | US 2 **مقطوع بـ** US 1 |
| US 1 **يملأ** US 2 | US 2 **ممتلئ بـ** US 1 |

### فحص العلاقات

يتحقق زر **Check rapporti** من اتساق العلاقات:
- يكتشف العلاقات المفقودة
- يجد التناقضات
- يشير إلى الأخطاء المنطقية

---

## تبويب البيانات الفيزيائية

يصف الخصائص الفيزيائية للوحدة الطبقية.

### الخصائص العامة

| الحقل | القيم |
|-------|-------|
| **اللون** | بني، أصفر، رمادي، أسود، إلخ |
| **القوام** | طيني، مضغوط، هش، رملي |
| **التكوين** | اصطناعي، طبيعي |
| **طريقة التكوين** | إضافة، إزالة، تراكم، انهيار |

### جداول المكونات

| الجدول | المحتوى |
|--------|---------|
| **المكونات العضوية** | عظام، خشب، فحم، بذور، إلخ |
| **المكونات غير العضوية** | حجارة، طوب، فخار، إلخ |
| **الشوائب الاصطناعية** | مواد بشرية متضمنة |

### أخذ العينات

| الحقل | القيم |
|-------|-------|
| **التعويم** | نعم / لا |
| **الغربلة** | نعم / لا |
| **الموثوقية** | ضعيف، جيد، متوسط، ممتاز |
| **حالة الحفظ** | غير كافٍ، ضعيف، جيد، متوسط، ممتاز |

---

## تبويب القياسات

يحتوي على جميع قياسات الوحدة الطبقية.

### الارتفاعات

| الحقل | الوصف | الوحدة |
|-------|--------|--------|
| **الارتفاع المطلق** | الارتفاع فوق مستوى سطح البحر | متر |
| **الارتفاع النسبي** | الارتفاع بالنسبة لنقطة مرجعية | متر |
| **الارتفاع الأقصى المطلق** | الارتفاع الأقصى المطلق | متر |
| **الارتفاع الأدنى المطلق** | الارتفاع الأدنى المطلق | متر |

### الأبعاد

| الحقل | الوصف | الوحدة |
|-------|--------|--------|
| **الطول الأقصى** | الطول الأقصى | متر |
| **العرض المتوسط** | العرض المتوسط | متر |
| **الارتفاع الأقصى** | الارتفاع الأقصى | متر |
| **السمك** | سمك الطبقة | متر |
| **العمق الأقصى** | العمق الأقصى | متر |

---

## تبويب التوثيق

يدير المراجع للتوثيق الرسومي والفوتوغرافي.

### جدول التوثيق

| العمود | الوصف |
|--------|--------|
| **نوع التوثيق** | صورة، مخطط، قطاع، واجهة، إلخ |
| **المراجع** | رقم/رمز الوثيقة |

### أنواع التوثيق

| النوع | الوصف |
|-------|--------|
| صورة | توثيق فوتوغرافي |
| مخطط | مخطط الحفر |
| قطاع | قطاع طبقي |
| واجهة | واجهة جدارية |
| رفع | رسم رفع |
| 3D | نموذج ثلاثي الأبعاد |

---

## تبويب التقنية البنائية USM

تبويب خاص بالوحدات الطبقية الجدارية (USM).

### بيانات USM الخاصة

| الحقل | الوصف |
|-------|--------|
| **طول USM** | طول الجدار (متر) |
| **ارتفاع USM** | ارتفاع الجدار (متر) |
| **السطح المحلل** | النسبة المئوية المحللة |
| **القطاع الجداري** | نوع القطاع |
| **الوحدة** | الوحدة البنائية |
| **نوع العمل** | نوع البناء |
| **الاتجاه** | اتجاه الهيكل |
| **إعادة الاستخدام** | نعم / لا |

### المواد والتقنيات

| القسم | الحقول |
|-------|--------|
| **الطوب** | المواد، المعالجة، القوام، الشكل، اللون، العجين، طريقة الوضع |
| **العناصر الحجرية** | المواد، المعالجة، القوام، الشكل، اللون، القطع، طريقة الوضع |

---

## تبويب الوسائط

يعرض الصور المرتبطة بالوحدة الطبقية.

### الأزرار

| الزر | الوظيفة |
|------|---------|
| **البحث عن صور** | البحث عن الصور المرتبطة |
| **حفظ** | حفظ الارتباطات |
| **تراجع** | إلغاء التعديلات |

---

## مصفوفة هاريس

مصفوفة هاريس هي تمثيل رسومي للعلاقات الطبقية.

> **فيديو تعليمي**: [رابط فيديو مصفوفة هاريس]

### إنشاء المصفوفة

1. اختر الموقع والمنطقة
2. تحقق من صحة العلاقات
3. اذهب إلى **تبويب المساعدة** ← **صندوق الأدوات**
4. انقر على **Export Matrix**

### صيغ التصدير

| الصيغة | البرنامج | الاستخدام |
|--------|----------|----------|
| DOT | Graphviz | عرض أساسي |
| GraphML | yEd, Gephi | تحرير متقدم |
| Extended Matrix | S3DGraphy | عرض ثلاثي الأبعاد |
| CSV | Excel | تحليل البيانات |

### Extended Matrix

تضيف المصفوفة الموسعة معلومات إضافية:
- التأريخ
- التعريفات التفسيرية
- البيانات الزمنية
- التوافق مع CIDOC-CRM

---

## وظائف GIS

بطاقة الوحدة الطبقية مدمجة بشكل وثيق مع QGIS.

### شريط أدوات GIS

| الزر | الوظيفة |
|------|---------|
| **GIS Viewer** | تحميل طبقات الوحدات الطبقية |
| **معاينة مخطط US** | معاينة الشكل الهندسي |
| **رسم US** | تفعيل الرسم |

### طبقات GIS المرتبطة

| الطبقة | الشكل الهندسي | الوصف |
|--------|--------------|--------|
| PYUS | مضلع | الوحدات الطبقية |
| PYUSM | مضلع | الوحدات الجدارية |
| PYQUOTE | نقطة | الارتفاعات |
| PYQUOTEUSM | نقطة | ارتفاعات USM |
| PYUS_NEGATIVE | مضلع | الوحدات الطبقية السالبة |

---

## التصدير

### بطاقات الوحدات الطبقية PDF

1. انقر على **Report** في شريط الأدوات
2. اختر الصيغة (PDF، Word)
3. اختر البطاقات للتصدير

### القوائم

| النوع | المحتوى |
|-------|---------|
| **قائمة US** | قائمة بجميع الوحدات الطبقية |
| **قائمة الصور مع الصور المصغرة** | قائمة مع معاينات |
| **قائمة الصور بدون الصور المصغرة** | قائمة بسيطة |
| **بطاقات US** | بطاقات كاملة |

---

## سير العمل التشغيلي

### إنشاء وحدة طبقية جديدة

#### الخطوة 1: فتح البطاقة

#### الخطوة 2: انقر على New Record

#### الخطوة 3: أدخل المعرفات
- اختر الموقع
- أدخل المنطقة
- أدخل رقم الوحدة الطبقية
- اختر النوع

#### الخطوة 4: التعريفات
- اختر التعريف الطبقي
- اختر التعريف التفسيري

#### الخطوة 5: الوصف
- أدخل الوصف الفيزيائي
- أدخل التفسير

#### الخطوة 6: العلاقات الطبقية
- أدخل العلاقات مع الوحدات الطبقية الأخرى
- أنشئ العلاقات العكسية

#### الخطوة 7: البيانات الفيزيائية والقياسات
- أدخل الخصائص الفيزيائية
- أدخل القياسات

#### الخطوة 8: الحفظ
- انقر على Save
- تحقق من الحفظ

---

## حل المشكلات

### خطأ في الحفظ
- تحقق من إدخال الموقع والمنطقة والوحدة الطبقية
- تحقق من أن المجموعة فريدة

### العلاقات غير متسقة
- استخدم فحص العلاقات
- تحقق من العلاقات العكسية
- صحح باستخدام زر Fix

### المصفوفة لا تُنشأ
- تحقق من تثبيت Graphviz
- تحقق من المسار في التكوين
- تحقق من وجود علاقات

### طبقات GIS لا تُحمّل
- تحقق من الاتصال بقاعدة البيانات
- تحقق من وجود أشكال هندسية
- تحقق من النظام المرجعي

---

## ملاحظات تقنية

### قاعدة البيانات

- **الجدول الرئيسي**: `us_table`
- **الحقول الرئيسية**: أكثر من 80 حقل
- **المفتاح الرئيسي**: `id_us`
- **المفتاح المركب**: الموقع + المنطقة + الوحدة الطبقية

### القاموس

حقول القاموس (التعريفات) تستخدم جدول `pyarchinit_thesaurus_sigle`:
- tipologia_sigla = '1.1' للتعريف الطبقي
- tipologia_sigla = '1.2' للتعريف التفسيري

---

*توثيق PyArchInit - بطاقة الوحدة الطبقية US/USM*
*الإصدار: 4.9.x*
*آخر تحديث: يناير 2026*
